# WB的3D容器（wbs_simple3D）
面向 TurboWarp 的自定义扩展：在积木层快速创建/管理 Three.js 3D 场景，支持模型导入、相机控制、光照、PBR 材质（MR/法线）、物理与后期效果等。


## 适用范围
- 目标平台：TurboWarp（Scratch 扩展机制）
- 渲染：WebGL（three.js）
- 物理：cannon-es

## 快速开始
1. 打开 TurboWarp 编辑器
2. 进入“扩展” → “自定义扩展”
3. 选择以下任一方式加载扩展：
   - 在线：粘贴你托管后的 `wbs_simple3D.js` URL
   - 本地：选择本仓库的 `wbs_simple3D.js`
4. 从积木中执行最小流程：
   - 创建 3D 容器（例如 `3D1`）
   - 添加一个基础模型（立方体/地面等）或导入 GLTF/OBJ
   - 添加光照（环境光/方向光/点光源/聚光灯）
   - 调整相机（位置/朝向/轨道控制）

示例工程：`sample.sb3`

## 功能概览（按积木分组）
扩展内提供的积木较多，以下为高层功能概览（以实际积木面板为准）：

- 🏗️ 容器管理：创建/删除容器、设置尺寸与背景、显示/隐藏、渲染相关开关（抗锯齿/VSync 等）
- 📷 摄像机控制：相机位置/旋转/目标、轨道控制等
- 🎲 3D模型创建：基础几何体、模型导入（GLTF/OBJ）、批量管理
- 🔄 模型变换：位置/旋转/缩放、可见性/透明度、阴影属性等
- 💡 光照系统：环境光、方向光、点光源、聚光灯；光照参数与颜色
- 🎨 材质系统：快速切换常用材质风格；支持 PBR（见下文）
- PBR（MR/法线）：金属度/粗糙度、MR 贴图、法线贴图、贴图采样（Wrap/Repeat/Offset/Rotation）
- 🎬 动画系统：播放/停止模型动画、查询动画列表
- 🎯 碰撞检测：模型间碰撞、距离/范围检测等
- ⚡ 物理系统：刚体、质量、阻尼、摩擦/弹性等
- 🔗 物理约束：弹簧/约束创建与事件（破坏原因、最近事件等）
- 滤镜效果：后期处理管线（如 Bloom 等）
- 🌅 天空盒和环境：天空参数、时段/自定义时间、云/星星等效果
- 📊 数据获取：获取模型状态/场景数据等

## PBR（MR/法线）用法提示
- “MR 贴图”会同时作为 `metalnessMap` 与 `roughnessMap` 使用（更贴近 glTF 常见工作流）。
- “贴图采样设置”可对 MR/法线贴图应用：Wrap（重复/夹紧/镜像）、Repeat、Offset、Rotation（度）。
- 建议流程：先将模型材质切换到 PBR 风格（如“金属材质/塑料材质”）→ 再设置 MR/法线贴图与采样参数。

## 依赖与鸣谢（Third‑Party）
本扩展在运行时会通过 CDN 动态加载部分第三方库/脚本与资源（Three.js 及其 examples、cannon-es 等）。这些第三方项目的版权归原作者所有。

示例项目 `sample.sb3` 还使用了 TurboWarp 官方扩展 Pointerlock（鼠标锁定），未做修改，通过官方扩展 CDN 导入。

完整列表与来源见 [THIRD_PARTY_NOTICES.md](THIRD_PARTY_NOTICES.md)。

## 许可证（MPLv2）
本仓库代码以 Mozilla Public License 2.0（MPL-2.0）开源。详见 [LICENSE](LICENSE)。

## 合规与分发说明（重要）
- 本扩展会在运行时从第三方 CDN 拉取依赖。若你准备“离线发布/内网部署/打包分发”，建议将依赖改为可控的镜像或本地副本，并确保满足第三方许可证要求。
  例如：分发第三方库的副本时，通常需要一并分发其许可证文本与版权声明。
- 若你修改并重新发布本扩展：请保留 MPLv2 要求的版权与许可证声明，并清晰标注修改内容与来源。
- 若你将第三方代码合并进本项目源码/发行包：请将该第三方许可证与版权声明加入到你的发行物（建议更新 `THIRD_PARTY_NOTICES.md`）。
## 安全提示
- 通过 CDN 动态加载脚本会带来可用性与供应链风险。生产使用建议固定版本、使用可信镜像，并尽量减少非必要外链。
